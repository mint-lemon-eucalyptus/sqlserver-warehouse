tinymce.PluginManager.add("sql", function (t) {
    t.addButton("sql", {text: "SQL", icon: !1, onclick: function () {
        t.windowManager.open({title: "SQL plugin", body: [
            {type: "textbox", name: "code", label: "",
                multiline: !0, minWidth: t.getParam("code_dialog_width", 600), minHeight: t.getParam("code_dialog_height", Math.min(tinymce.DOM.getViewPort().h - 200, 500))
            }
        ],
            onsubmit: function (e) {
                t.insertContent(
                    //  var uid=((new Date()).getMilliseconds());
                    "<div readonly class='code-textarea'>" + e.data.code + "</div>" +
                        '<a class="btn btn-info" target="_blank" href="/exec-query?type=sql&q=' + encodeURI(e.data.code) + '">run</a>'
                )
            }
        })
    }}),
        t.addMenuItem("sql", {text: "SQL plugin", context: "tools", onclick: function () {
            t.windowManager.open({title: "TinyMCE site", url: "http://www.tinymce.com", width: 800, height: 600, buttons: [
                {text: "Close", onclick: "close"}
            ]})
        }})
})
;

/*
 tinymce.PluginManager.add("code", function (e) {
 function o() {
 t.windowManager.open({title: "Source code", body: {type: "textbox", name: "code", multiline: !0, minWidth: e.getParam("code_dialog_width", 600), minHeight: e.getParam("code_dialog_height", Math.min(tinymce.DOM.getViewPort().h - 200, 500)), value: e.getContent({source_view: !0}), spellcheck: !1, style: "direction: ltr; text-align: left"}, onSubmit: function (o) {
 e.focus(), e.undoManager.transact(function () {
 e.setContent(o.data.code)
 }), e.selection.setCursorLocation(), e.nodeChanged()
 }})
 }

 e.addCommand("mceCodeEditor", o), e.addButton("code", {icon: "code", tooltip: "Source code", onclick: o}), e.addMenuItem("code", {icon: "code", text: "Source code", context: "tools", onclick: o})
 });
 */